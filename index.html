<!DOCTYPE html>
<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>FotoTube Firebase 100 Foto</title>
  <script type="module">
    // --- Firebase Import ---
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getFirestore, doc, getDoc, setDoc, updateDoc, onSnapshot, arrayUnion } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    // --- Firebase Config ---
    const firebaseConfig = {
      apiKey: "AIzaSyCx2hqab1MAV_4NbnyEMKVRddry1_2ScNo",
      authDomain: "project-2-e9457.firebaseapp.com",
      projectId: "project-2-e9457",
      storageBucket: "project-2-e9457.firebasestorage.app",
      messagingSenderId: "244673617483",
      appId: "1:244673617483:web:47e53c4ddf5d27d15277ce"
    };

    // Init Firebase
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // --- 100 Foto Manual (isi link & judul sesuai kebutuhan) ---
    const photos = [
      { id: "foto1", url: "https://files.catbox.moe/0sn3nk.jpg", title: "Foto Pertama" },
      { id: "foto2", url: "", title: "Foto Kedua" },
      { id: "foto3", url: "", title: "Foto Ketiga" },
      // ...
      { id: "foto100", url: "", title: "Foto Ke-100" }
    ];

    window.addEventListener("DOMContentLoaded", () => {
      const gallery = document.getElementById("gallery");

      photos.forEach((photo) => {
        if (!photo.url) return; // hanya tampil kalau ada URL foto

        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <img src="${photo.url}" alt="${photo.title}">
          <h3>${photo.title}</h3>
          <div class="actions">
            <button onclick="likeFoto('${photo.id}')">üëç Like (<span id="like-${photo.id}">0</span>)</button>
          </div>
          <div class="comments">
            <input type="text" id="input-${photo.id}" placeholder="Tulis komentar...">
            <button onclick="addComment('${photo.id}')">Kirim</button>
            <div id="list-${photo.id}"></div>
          </div>
        `;
        gallery.appendChild(card);

        // Realtime update Firestore
        onSnapshot(doc(db, "photos", photo.id), (docSnap) => {
          if (docSnap.exists()) {
            const data = docSnap.data();
            document.getElementById(`like-${photo.id}`).innerText = data.likes || 0;

            const list = document.getElementById(`list-${photo.id}`);
            list.innerHTML = "";
            (data.comments || []).forEach(c => {
              const div = document.createElement("div");
              div.className = "comment";
              div.innerText = c;
              list.appendChild(div);
            });
          } else {
            // Buat data default kalau belum ada
            setDoc(doc(db, "photos", photo.id), { likes: 0, comments: [] });
          }
        });
      });
    });

    // Fungsi Like
    window.likeFoto = async (id) => {
      const ref = doc(db, "photos", id);
      const snap = await getDoc(ref);
      if (snap.exists()) {
        const data = snap.data();
        await updateDoc(ref, { likes: (data.likes || 0) + 1 });
      }
    };

    // Fungsi Komentar
    window.addComment = async (id) => {
      const input = document.getElementById(`input-${id}`);
      const text = input.value.trim();
      if (text !== "") {
        const ref = doc(db, "photos", id);
        await updateDoc(ref, { comments: arrayUnion(text) });
        input.value = "";
      }
    };
  </script>
  <style>
    body { font-family: Arial, sans-serif; background:#f4f4f4; margin:0; padding:20px; }
    h2 { text-align:center; }
    .gallery { display:grid; grid-template-columns:repeat(auto-fill,minmax(280px,1fr)); gap:15px; max-width:1200px; margin:auto; }
    .card { background:#fff; padding:10px; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.2); }
    img { width:100%; border-radius:8px; }
    h3 { font-size:16px; margin:8px 0; }
    .comment { background:#eee; padding:5px; margin-top:5px; border-radius:4px; font-size:14px; }
    input { width:70%; padding:5px; margin-top:5px; }
    button { padding:5px 10px; margin-top:5px; background:#007bff; color:white; border:none; border-radius:5px; cursor:pointer; }
    button:hover { background:#0056b3; }
  </style>
</head>
<body>
  <h2>üì∏ FotoTube dengan Firebase (100 Slot)</h2>
  <div class="gallery" id="gallery"></div>
</body>
</html>
